{% extends 'mainpage/base.html' %}
{% load static %}

{% block title %}Posts{% endblock %}

{% block content %}
<div class="container my-5 text-light" style="max-width: 900px; margin-left: auto; margin-right: auto; padding-left: 1.5rem; padding-right: 1.5rem;">

  <!-- Create Post Card -->
  {% if user.is_authenticated %}
  <div id="createPostCard" class="card bg-dark border-secondary text-white shadow-sm mb-5 p-3" style="cursor: pointer;">
    <div class="d-flex align-items-center">
      <img src="https://via.placeholder.com/40" class="rounded-circle me-3" alt="User" width="40" height="40">
      <span class="text-white flex-grow-1">What's on your mind?</span>
      <i class="bi bi-plus-circle h4 text-info mb-0"></i>
    </div>
  </div>

  <script>
    document.getElementById('createPostCard').addEventListener('click', function () {
      window.location.href = "{% url 'create_post' %}";
    });
  </script>
  {% endif %}

  <!-- Posts Section -->
  <h2 class="mb-4"><i class="bi bi-journals me-2"></i>Latest Blog Posts</h2>

  {% for post in posts %}
  <div class="card bg-dark border-secondary text-light mb-4 shadow-sm post-card">
    <div class="card-body">
      <h4 class="card-title">
        <a href="{% url 'post_detail' slug=post.slug %}" class="text-decoration-none text-info">
          {{ post.title }}
        </a>
      </h4>
      <p class="card-subtitle small mb-2 text-light">
        By {{ post.author.username }} Â· {{ post.created_at|date:"M d, Y" }}
      </p>
      <p class="card-text">
        {{ post.content|truncatewords:40 }}
      </p>
      <a href="{% url 'post_detail' slug=post.slug %}" class="btn btn-outline-info btn-sm mt-2">Read More</a>
    </div>
  </div>
  {% empty %}
  <p class="text-light">No posts have been published yet.</p>
  {% endfor %}
</div>

<!-- Optional CSS for hover effect -->
<style>
  .post-card:hover {
    background-color: #1f1f1f;
    border-color: #0d6efd;
    transition: 0.3s ease;
  }
</style>
{% endblock %}
